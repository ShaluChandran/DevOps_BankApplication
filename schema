schema working previous:

String types = "struct<pos_log_transaction_type:string,legacy_transaction_id:string,transaction_id:string,transaction_post_date_time:string,source_app:string,business_unit:struct<location_id:string,legacy_location_id:string>,origination_channel:struct<channel_id:string,fulfillment_type:string,division_code:string,version_id:string>,ship_from_address:struct<address_line:string,city:string,territory:string,postal_code:string,postal_code_extension:string>,begin_date_time:string,end_date_time:string,begin_date_time_iso:string,end_date_time_iso:string,operator_id:string,receipt_date_time:string,order_date:string,register_id:string,register_sequence_number:string,training_mode:string,transaction_net_amount:string,transaction_status:string,transaction_type_code:string,customer_order_number:string,customer_invoice_number:string,customer_shipment_number:string,release_id:string,guest_information:struct<guest_tracking_id:string,loyalty_barcode:string,employee_id:string,cartwheel_barcode:string>,ship_to_destination:struct<store_id:string,address_line:string,city:string,territory:string,postal_code:string,postal_code_extension:string>,related_transactions:array<struct<related_type_code:string,legacy_transaction_id:string,customer_order_number:string>>,line_items:array<struct<line_item_sequence_number:string,line_item_type:string,barcode:string,barcode_type:string,serial_number:string,dpci:string,tcin:string,inventory_tcin:string,vendor_id:string,vendor_type:string,seller_id:string,weight:string,item_voided:string,regular_unit_price:string,quantity:string,unit_of_measure:string,selling_unit_price:string,extended_net_amount:string,tax_area_id:string,tax_class_code:string,vendor_return_financial_disposition:string,refund_code:string,return_policies:array<struct<end_date:string,guest_type:string,policy_days:string,policy_id:string>>,line_related_transaction:struct<original_legacy_transaction_id:string,original_line_item_sequence_number:string>,service_charges:array<struct<line_item_sequence_number:string,line_item_type:string,dpci:string,tcin:string,inventory_tcin:string,item_voided:string,regular_unit_price:string,quantity:string,unit_of_measure:string,selling_unit_price:string,extended_net_amount:string,tax_area_id:string,tax_class_code:string>>,price_modifiers:array<struct<price_modifier_sequence_number:string,price_modifier_type:string,price_modifier_reason_code:string,promotion_id:string,original_amount:string,adjustment_amount:string>>,taxes:array<struct<tax_sequence_number:string,tax_override_code:string,tax_type_code:string,tax_percent:string,tax_rate_code:string,tax_voided:string,taxable_amount:string,tax_amount:string,tax_exempt:string,tax_exempt_amount:string>>>>,price_modifier_summaries:array<struct<price_modifier_event_sequence_number:string,price_modifier_reason_code:string,price_modifier_type:string,promotion_id:string,price_modifier_percent:string,price_modifier_amount:string,pre_modifier_sales_total_amount:string,price_modifier_calculation_code:string,price_modifier_voided:string,price_variance_reason_code:string,allocated_to_item:string,assigned_dpci:string,cartwheel_flag:string,related_line_items:array<struct<line_item_sequence_number:string>>>>,tax_summaries:array<struct<event_sequence_number:string,tax_type:string,tax_table_code:string,tax_type_code:string,tax_override_code:string,tax_percent:string,tax_rate_code:string,tax_source_code:string,tax_voided:string,taxable_amount:string,tax_amount:string,tax_exempt:string,tax_exempt_amount:string,tax_related_line_items:array<struct<line_item_sequence_number:string>>>>,tender_summaries:array<struct<tender_sequence_number:string,tender_tracking_id:string,tender_tran_type:string,tender_type_code:string,merchant_id:string,order_type:string,tender_document_number:string,gl_account:string,currency_code:string,tender_amount:string,tender_entry_method:string,cash_back_amount:string,tender_voided:string,credit_information:struct<charge_count:string,charge_sequence:string,card_token:string,external_token:string,token_type:string,token_status:string,bank_card_type:string,chip_read_flag:string,expiration_month:string,expiration_year:string,debit_network:string,stringerchange_profile_code:string,cardholder_verification_result:string,trace_audit_number:string,merchant_type_code:string,terminal_country_code:string,terminal_serial_id:string,terminal_verification_result:string,terminal_capability:string,application_version:string,application_data:string,application_transaction_count:string,device_form_factor:string,transaction_type_code:string,card_subtype:string>,authorization:struct<authorization_amount:string,authorization_response_cryptogram:string,authorization_response:string,cavv:string,cavv_response_code:string,avv:string,cryptogram_type_code:string,cryptogram_code:string,cryptogram_random_string:string,market_specific_authorization_code:string,pos_data_text:string,service_code:string,approval_code:string,approval_id:string,approval_date_time:string,error_code:string,receive_timestamp:string,response_code:string,request_id:string,send_timestamp:string>,tender_related_line_items:array<struct<line_item_sequence_number:string>>>>,curr_ts:string,curr_prcs_d:string>";


schema new:

struct<pos_log_transaction_type:string,legacy_transaction_id:string,transaction_id:string,transaction_post_date_time:string,source_app:string,adjustment_version:int,business_unit:struct<location_id:string,legacy_location_id:string,location_type:string>,origination_channel:struct<channel_id:string,fulfillment_type:string,division_code:string,company_code:string,version_id:string>,ship_from_address:struct<address_line:string,city:string,state:string,territory:string,postal_code:string,postal_code_extension:string>,begin_date_time:string,end_date_time:string,begin_date_time_iso:string,end_date_time_iso:string,operator_id:string,receipt_date_time:string,order_date:string,register_id:string,register_sequence_number:string,training_mode:boolean,transaction_net_amount:string,transaction_status:string,transaction_type_code:string,customer_order_number:string,customer_invoice_number:string,customer_shipment_number:string,scac:string,release_id:string,guest_information:struct<guest_tracking_id:string,first_name:string,last_name:string,email_address:string,loyalty_barcode:string,cartwheel_barcode:string,guest_profile_id:string,employee_id:string,tax_information:array<struct<organization_name:string,organization_type:string,organization_tax_id:string,organization_street_address:string,organization_city:string,organization_state:string,organization_zip_code:string,organization_country:string,organization_phone_number:string,tax_exempt_number:string,tax_exempt_type:string,purchaser_first_name:string,purchaser_last_name:string,purchaser_street_address:string,purchaser_city:string,purchaser_state:string,purchaser_zip_code:string,purchaser_country:string,purchaser_occupation:string,purchaser_id_number:string,purchaser_id_type:string,purchaser_id_state:string,purchaser_id_expiration:string,purchaser_date_of_birth:string,purchaser_ssn:string>>>,ship_to_destination:struct<store_id:string,address_line:string,city:string,state:string,territory:string,postal_code:string,postal_code_extension:string>,related_transactions:array<struct<related_type_code:string,legacy_transaction_id:string,transaction_id:string,customer_order_number:string>>,line_items:array<struct<line_item_sequence_number:int,line_item_tracking_id:string,line_item_type:string,barcode:string,barcode_type:string,serial_number:string,dpci:string,tcin:string,inventory_tcin:string,vendor_id:string,vendor_type:string,seller_id:string,weight:string,item_voided:boolean,regular_unit_price:string,quantity:string,unit_of_measure:string,selling_unit_price:string,extended_net_amount:string,tax_area_id:string,tax_class_code:string,registry_number:string,inventory_removal_number:string,vendor_return_physical_disposition:string,vendor_return_financial_disposition:string,refund_code:string,return_reason:string,return_policies:array<struct<end_date:string,guest_type:string,policy_days:string,policy_id:string>>,line_related_line_items:array<struct<line_item_tracking_id:string>>,line_related_transaction:struct<original_legacy_transaction_id:string,original_line_item_sequence_number:int>,component_item:array<struct<tcin:string>>,child_order:array<struct<child_order_location_id:string,child_order_shipment_number:string>>,service_charges:array<struct<line_item_sequence_number:int,service_charge_tracking_id:string,line_item_type:string,dpci:string,tcin:string,inventory_tcin:string,item_voided:boolean,regular_unit_price:string,quantity:string,unit_of_measure:string,selling_unit_price:string,extended_net_amount:string,tax_area_id:string,tax_class_code:string>>,price_modifiers:array<struct<price_modifier_sequence_number:int,price_modifier_tracking_id:string,price_modifier_type:string,price_modifier_name:string,price_modifier_reason_code:string,promotion_id:string,original_amount:string,adjustment_amount:string>>,taxes:array<struct<tax_sequence_number:int,tax_tracking_id:string,tax_override_code:string,tax_type_code:string,tax_percent:string,tax_rate_code:string,tax_voided:boolean,taxable_amount:string,tax_amount:string,tax_exempt:boolean,tax_exempt_amount:string>>>>,price_modifier_summaries:array<struct<price_modifier_event_sequence_number:int,price_modifier_reason_code:string,price_modifier_type:string,price_modifier_name:string,promotion_id:string,price_modifier_percent:string,price_modifier_amount:string,pre_modifier_sales_total_amount:string,price_modifier_calculation_code:string,price_modifier_voided:boolean,price_variance_reason_code:string,allocated_to_item:string,assigned_dpci:string,cartwheel_flag:string,related_line_items:array<struct<line_item_tracking_id:string>>>>,tax_summaries:array<struct<event_sequence_number:int,tax_type:string,tax_table_code:string,tax_type_code:string,tax_override_code:string,tax_percent:string,tax_rate_code:string,tax_source_code:string,tax_voided:boolean,taxable_amount:string,tax_amount:string,tax_exempt:boolean,tax_exempt_amount:string,tax_related_line_items:array<struct<line_item_tracking_id:string>>>>,tender_summaries:array<struct<tender_sequence_number:int,tender_tracking_id:string,tender_tran_type:string,merchant_id:string,order_type:string,tender_document_number:string,gl_account:string,currency_code:string,tender_amount:string,tender_entry_method:string,payment_method:string,cash_back_amount:string,tender_voided:boolean,credit_information:struct<charge_count:string,charge_sequence:string,card_token:string,external_token:string,token_type:string,token_status:string,bank_card_type:string,chip_read_flag:boolean,expiration_month:string,expiration_year:string,debit_network:string,interchange_profile_code:string,cardholder_verification_result:string,trace_audit_number:string,merchant_type_code:string,terminal_country_code:string,terminal_serial_id:string,terminal_verification_result:string,terminal_capability:string,application_version:string,application_data:string,application_transaction_count:string,device_form_factor:string,transaction_type_code:string,card_subtype:string>,authorization:struct<authorization_amount:string,authorization_response_cryptogram:string,authorization_response:string,cavv:string,cavv_response_code:string,avv:string,cryptogram_type_code:string,cryptogram_code:string,cryptogram_random_string:string,market_specific_authorization_code:string,pos_data_text:string,service_code:string,approval_code:string,approval_id:string,approval_date_time:string,error_code:string,receive_timestamp:string,response_code:string,request_id:string,send_timestamp:string>,bill_to_address:struct<address_line:string,city:string,state:string,territory:string,postal_code:string,postal_code_extension:string>,tender_related_line_items:array<struct<line_item_tracking_id:string>>>>>



d
